<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Post</title>
    <style>
        label{
            display: block;
        }
    </style>
</head>
<body>
    <div>
        <form enctype="multipart/form-data" id="my-form">
            <label>
                Title: <br>
                <input type="text" id="title">
            </label>

            <label>
                Content: <br>
                <textarea id="content" cols="30" rows="10"></textarea>
            </label>
            <label>
                Image: <br>
                <input type="file" id="image" accept=".png, .jpg, .jpeg">
            </label>
            <button id="make-post">Make Post</button>
        </form>
    </div>

    <script>
       // Variables
const title = document.getElementById("title"),
    content = document.getElementById("content"),
    image = document.getElementById("image"),
    postBtn = document.getElementById("make-post")

postBtn.addEventListener("click", function (e) {
    e.preventDefault();
    console.log(image.files[0])
    // Define the API endpoint URL and data
    const apiUrl = 'http://127.0.0.1:8000/posts/api/7cee17c1e493d00bb72bbc14ef1dab8512a0634e'; // Replace with your API endpoint

    const data = new FormData();
    data.append('title', title.value);
    data.append('body', content.value);
    data.append('image', image.files[0]);

    // Define request options
    const requestOptions = {
        method: 'POST',
        body: data,
        headers:{
            "Authorization": "Token 7cee17c1e493d00bb72bbc14ef1dab8512a0634e"
        }
    };

    // Send the POST request
    fetch(apiUrl, requestOptions, )
        .then((response) => {
            if (response.status === 201) { // Replace with the expected status code
                return response.json(); // If expecting JSON response
            } else {
                throw new Error(`POST request failed with status: ${response.status}`);
            }
        })
        .then((data) => {
            console.log('POST request was successful');
            console.log('Response data:', data);
        })
        .catch((error) => {
            console.error(error);
        });
});

    </script>
</body>
</html>